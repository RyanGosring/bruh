; Coq for macos does not support native compilation yet.
; TODO Enable tests when ready

(cram
 (applies_to :whole_subtree)
 (deps %{bin:coqc} %{bin:coqdep} %{bin:coqmod})
 (alias runtest-coq)
 (enabled_if
  (= %{env:DUNE_COQ_TEST=disable} enable)))

(cram
 (applies_to native-compose native-single)
 (enabled_if
  (<> %{system} macosx)))

(cram
 (alias runtest-coq)
 (applies_to coqffi)
 (deps %{bin:coqffi})
 (enabled_if
  (= %{env:DUNE_COQ_TEST=disable} enable)))

(cram
 (alias runtest-coq)
 (applies_to coq-of-ocaml)
 (deps %{bin:coq-of-ocaml})
 (enabled_if
  (= %{env:DUNE_COQ_TEST=disable} enable)))

(env
 (_
  (binaries
   (fakebin/coq_of_ocaml.exe as coq-of-ocaml)
   (fakebin/coqffi.exe as coqffi)
   (../../../../src/coqmod/coqmod_main.exe as coqmod))))
