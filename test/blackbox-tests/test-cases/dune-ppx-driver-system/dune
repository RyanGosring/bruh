; No driver found
(library
 ((name foo1)
  (public_name foo.1)
  (modules (foo1))
  (preprocess (pps ()))))

; Too many drivers
(library
 ((name foo2)
  (public_name foo.2)
  (modules (foo2))
  (preprocess (pps (ppx1 ppx2)))))

; Incompatible with Dune
(library
 ((name foo3)
  (public_name foo.3)
  (modules (foo3))
  (preprocess (pps (ppx_other)))))

(rule (with-stdout-to foo1.ml (echo "")))
(rule (with-stdout-to foo2.ml (echo "")))
(rule (with-stdout-to foo3.ml (echo "")))

(library
 ((name ppx1)
  (public_name foo.ppx1)
  (kind ppx_rewriter)
  (modules ())
  (libraries (driver1))))

(library
 ((name ppx2)
  (public_name foo.ppx2)
  (kind ppx_rewriter)
  (modules ())
  (libraries (driver2))))

(library
 ((name driver1)
  (public_name foo.driver1)
  (modules ())
  (ppx.driver ((main "(fun () -> assert false)")))))

(library
 ((name driver2)
  (public_name foo.driver2)
  (modules ())
  (ppx.driver ((main "(fun () -> assert false)")))))

(library
 ((name ppx_other)
  (public_name foo.ppx-other)
  (modules ())
  (kind ppx_rewriter)))
