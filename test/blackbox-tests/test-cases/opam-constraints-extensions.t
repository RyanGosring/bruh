TODO:
- can an extension push different constraints based on the extension version?
- what to do if constraint is already present?

  $ gen_project () {
  > cat > dune-project << EOF
  > (lang dune $1)
  > (using mdx 0.3)
  > (generate_opam_files)
  > (package
  >  (name n)
  >  (allow_empty))
  > EOF
  > }

  $ gen_project 3.17

  $ dune build

  $ cat n.opam
  # This file is generated by dune, edit dune-project instead
  opam-version: "2.0"
  depends: [
    "mdx" {>= "1.6.0"}
    "dune" {>= "3.17"}
    "odoc" {with-doc}
  ]
  build: [
    ["dune" "subst"] {dev}
    [
      "dune"
      "build"
      "-p"
      name
      "-j"
      jobs
      "@install"
      "@runtest" {with-test}
      "@doc" {with-doc}
    ]
  ]

  $ gen_project 3.16

  $ dune build

  $ cat n.opam
  # This file is generated by dune, edit dune-project instead
  opam-version: "2.0"
  depends: [
    "dune" {>= "3.16"}
    "odoc" {with-doc}
  ]
  build: [
    ["dune" "subst"] {dev}
    [
      "dune"
      "build"
      "-p"
      name
      "-j"
      jobs
      "@install"
      "@runtest" {with-test}
      "@doc" {with-doc}
    ]
  ]
